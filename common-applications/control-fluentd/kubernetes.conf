<label @FLUENT_LOG>
        <match fluent.**>
                @type null
        </match>
</label>

<source>
        @type tail
        @id in_tail_container_logs
        path /var/log/containers/*.log
        pos_file /var/log/fluentd-containers.log.pos
        tag "#{ENV['FLUENT_CONTAINER_TAIL_TAG'] || 'kubernetes.*'}"
        exclude_path "#{ENV['FLUENT_CONTAINER_TAIL_EXCLUDE_PATH'] || use_default}"
        read_from_head true
        <parse>
                @type "#{ENV['FLUENT_CONTAINER_TAIL_PARSER_TYPE'] || 'json'}"
                time_format %Y-%m-%dT%H:%M:%S.%NZ
        </parse>
</source>

<source>
        @type tail
        @id in_tail_docker
        path /var/log/docker.log
        pos_file /var/log/fluentd-docker.log.pos
        tag docker control-cluster
        <parse>
                @type regexp
                expression /^time="(?<time>[^)]*)" level=(?<severity>[^ ]*) msg="(?<message>[^"]*)"( err="(?<error>[^"]*)")?( statusCode=($<status_code>\d+))?/
        </parse>
</source>

<source>
        @type tail
        @id in_tail_kubelet
        multiline_flush_interval 5s
        path /var/paas/sys/log/kubernetes/kubelet.log
        pos_file /var/log/fluentd-kubelet.log.pos
        tag kubelet control-cluster
        <parse>
                @type kubernetes
        </parse>
</source>

<source>
        @type tail
        @id in_tail_kube_proxy
        multiline_flush_interval 5s
        path /var/paas/sys/log/kubernetes/kube-proxy.log
        pos_file /var/log/fluentd-kube-proxy.log.pos
        tag kube-proxy control-cluster
        <parse>
                @type kubernetes
        </parse>
</source>

<source>
        @type tail
        @id in_tail_everest_driver
        multiline_flush_interval 5s
        path /var/paas/sys/log/everest-csi-driver/everest-csi-driver-standalone.log
        pos_file /var/log/everest-csi-driver.log.pos
        tag everest control-cluster
        <parse>
                @type kubernetes
        </parse>
</source>

<source>
        @type tail
        @id in_tail_everest_driver_connector
        multiline_flush_interval 5s
        path /var/paas/sys/log/everest-csi-driver/everest-host-connector.log
        pos_file /var/log/everest-csi-driver-connector.log.pos
        tag everest control-cluster
        <parse>
                @type kubernetes
        </parse>
</source>